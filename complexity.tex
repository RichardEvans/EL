\section{Complexity of the decision procedure}


\begin{eqnarray*}
  \SIMPL{\top} &\ = \ & ( (\{v\}, \{\}, \{v \mapsto \Sigma\}), v)  \\
  \SIMPL{\fBang A} & = & ( (\{v\}, \{\}, \{v \mapsto A\}), v)  \\
  \SIMPL{\phi_1 \AND \phi_2} & = & \SIMPL{\phi_1} \sqcap \SIMPL{\phi_2}  \\
  \SIMPL{\langle a \rangle \phi} 
     & = & ( (S \cup \{w'\}, \rightarrow \cup (w' \xrightarrow{a} w), \lambda \cup \{w' \mapsto \Sigma\}]), w')  \\
		& & \mbox{where }\SIMPL{\phi} = ( (S, \rightarrow, \lambda), w) \mbox{and } w' \mbox{ is a new state} \\
                &&  \mbox{not appearing in }S 
\end{eqnarray*}
\begin{eqnarray*}
  \bot \sqcap \MMM  &\ =\ &  \bot  
     \\
  \MMM \sqcap \bot      & = &  \bot  
     \\
  \MMM \sqcap \MMM'
     & = & 
  \mathsf{merge}(\mathcal{L}, \mathcal{L}', \{(w,w')\}) 
     \\
     & & \text{where } \MMM = (\mathcal{L}, w) \text{ and } \MMM' = (\mathcal{L'}, w')
\end{eqnarray*}
\begin{eqnarray*}
  \mathsf{merge}(\mathcal{L}, \mathcal{L}', ids) 
     & = & 
  \begin{cases}
    \bot \text{ if } \mathsf{inconsistent}(\mathcal{L}, \mathcal{L}', ids)  \\
    \mathsf{join}(\mathcal{L}, \mathcal{L}') \text{ if } ids = \emptyset  \\
    \mathsf{merge}(\mathcal{L}, \mathcal{L}'', ids')  \\
    \text{ where }  \mathcal{L}'' = \mathsf{applyIds}(ids, \mathcal{L}') \text{ and } ids' = \mathsf{getIds}(\mathcal{L}, \mathcal{L}', ids)
  \end{cases}
\end{eqnarray*}
\[
   \mathsf{inconsistent}(\mathcal{L}, \mathcal{L}', ids) \text{ iff } \exists (w,w') \in ids \; . \; \mathsf{out}(\mathcal{L},w) \nsubseteq \lambda'(w') \; \lor \; \mathsf{out}(\mathcal{L}',w') \nsubseteq \lambda(w)
\]
 \NI Here:
\[
  \mathsf{out}(((S,\rightarrow,\lambda),w)) 
     \ =\  \{ a \fOr \exists w' . w \xrightarrow{a} w'\} 
\]
The $\mathsf{join}$ function takes the union of the two LTSs.
\[
\mathsf{join}((S, \rightarrow,\lambda), (S', \rightarrow', \lambda')) = (S \cup S', \rightarrow \cup \rightarrow', \{\lambda(x) \cap \lambda'(x) \; | \; x \in S \cup S'\})
\]
The $\mathsf{applyIds}$ function applies all the state-identification pairs as substitutions to the Labelled Transition System:
\[
\mathsf{applyIds}(ids, (S, \rightarrow, \lambda)) = (S', \rightarrow', \lambda')
\]
where
\begin{eqnarray*}
S' & = & S \; [ w / w' \; | \; (w,w') \in ids] \\
\rightarrow' & = & \rightarrow \; [ w / w' \; | \; (w,w') \in ids] \\
\lambda' & = & \lambda \; [ w / w' \; | \; (w,w') \in ids]
\end{eqnarray*}

\NI Here $[ w / w' \; | \; (w,w') \in ids]$ means the simultaneous
substitution of $w$ for $w'$ for all pairs $(w, w')$ in $ids$.  The
$\mathsf{getIds}$ function returns the set of extra
state-identification pairs that need to be added to respect
determinism:
\[
\mathsf{getIds}(\mathcal{L}, \mathcal{L}', ids) = \{(x,x') \; | \; (w,w') \in ids, \exists a \; . \; w \xrightarrow{a} x, w' \xrightarrow{a} x'\}
\]
