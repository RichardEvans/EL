\section{\ELFULL}\label{coreEL}

In this section we introduce the syntax and semantics of \ELFULL{}
(hereafter \ELABR{}).  

\subsection{Syntax}
\label{elsyntax}
\NI Syntactically, eremic logic is a multi-modal logic with one new
operator.

\begin{definition} Let $\Sigma$ be a non-empty set of \emph{actions}.
Actions are ranged over by $a, a', a_1, b, ...$, and $A$ ranges over
finite subsets of $\Sigma$. The \emph{formulae}, ranged over by $\phi,
\psi, \xi ...$, of \ELABR{} are given by the
following grammar.

\begin{GRAMMAR}
  \phi 
     &\quad ::= \quad & 
  \TRUE 
     \VERTICAL 
  \phi \AND \psi
     \VERTICAL 
  \MAY{a}{\phi}
     \VERTICAL 
  \fBang A 
\end{GRAMMAR}
\end{definition}

\NI  Before presenting models and the satisfaction relation, we sketch
the meaning of formulae informally. $\TRUE$ is truth and $\phi \AND
\psi$ is the conjunction of formulae $\phi$ and $\psi$. Clearly
$\MAY{a}{\phi}$ is the may-modality which asserts that the current
state may do action $a$ and in doing $a$ transitions into a now state
at which $\phi$ holds.  The key novelty of eremic logic is $!A$,
pronounced ``just $A$, or ``tantum $A$. The core intuition about $!A$
is that if a model validates $!A$ at the current state, then the only
modalities $\MAY{a}{}$ available at the corrent state are those with
$a \in A$. 

The set of actions must be non-empty to avoid that the logic is
trivial. The restriction to finite subsets of action substantially
simplifies the meta-theory of the logic.

We often abbreviate $\MAY{a}{\TRUE}$ to $\MAY{a}{}$. We define falsity
$\FALSE$ as $!\emptyset \AND \MAY{a}{}$ where $a$ is an arbitrary
action. Note that in the absence of conventional negation, we cannot
readily define disjunction, implication, or must-modalities by de
Morgan duality. We discuss later \martin{Where?} how some of the usual
propositional connectives can be (partially) recovered. \martin{What
  about must modalities?}

\begin{convention}
From now on we assume a fixed set $\Sigma$ of actions, except where
stated otherwise.
\end{convention}

\subsection{Semantics}

\NI The semantics of eremic logic is close to Hennessy-Milner logic
\cite{HennessyM:alglawfndac} but uses \emph{deterministic} transition systems, as
described in Section \ref{preliminaries}, augmented with labels on
states.

\begin{definition}

\NI We say $\LLL$ is \emph{deterministic} if $x \TRANS{a} y$ and $x \TRANS{a} z$ imply that $y = z$. Otherwise $\LLL$ is
\emph{non-deterministic}.
\end{definition}

An \emph{eremic transition system} is a triple $\LLL = (S, \rightarrow,
\lambda)$, where $(S, \rightarrow)$ is a \emph{deterministic} labelled transition system
over $\Sigma$, and $\lambda$ is a function from states to sets of
actions (not necessarily finite), subject to the following constraints:
\begin{itemize}

\item For all states $s \in S$ it is the case that $ \{a \fOr \exists
  t \; s \xrightarrow{a} t\} \subseteq \lambda(s)$. We call this
  condition \emph{admissibility}.

\item For all states $s \in S$, $\lambda (s)$ is either finite or
  $\Sigma$. We call this condition \emph{well-sizedness}.

\end{itemize}

\NI The intended interpretation is that $\lambda(w)$ is the set of
allowed transition symbols emanating from $w$.  The $\lambda$ function
is the semantic counterpart of the $!$ operator.  The admissibility
restriction is in place because transitions $s \TRANS{a} t$ where $a
\notin \lambda(s)$ would be saying that an $a$ action is possible at
$s$ but at the same time prohibit $a$ actions at that state.
Well-sizedness is not a fundamental restriction but rather a
convenient trick. Essentially eremic transition systems have two kinds
of nodes:

\begin{itemize}

\item Nodes $s$ without restrictions on outgoing transitions. Those are
  labelled with $\lambda ( s) = \Sigma$.

\item Nodes $s$ with restriction on outgoing transitions. Those are
  labelled by a finite set $\lambda ( s)$ of actions.

\end{itemize}

\NI Defining $\lambda$ on all nodes and not just on those with
restrictions makes some definitions and proofs slightly easier.

As with other modal logics, satisfaction of formulae is defined
relative to a state in the ambient eremic transition system, giving
rise to the following definition.

\begin{definition}
A \emph{eremic model}, ranged over by $\MMM, \MMM', ...$, is a pair
$(\LLL, s)$, where $\LLL$ is an eremic transition system $(S,
\rightarrow, \lambda)$, and $s$ is a state from $S$. We call $s$ the
\emph{root} of the model.
\end{definition}

\NI With eremic models at hand, we can finally formalise the
satisfaction relation for eremic formulae.

\begin{definition}\label{ELsatisfaction}
The \emph{satisfaction relation} $\MMM \models \phi$ is defined
inductively by the following clauses, where we assume that $\MMM =
(\LLL, s)$ and $\LLL = (S, \rightarrow, \lambda)$.

\[
\begin{array}{lclcl}
  \MMM & \models & \top   \\
  \MMM & \models & \phi \AND \psi &\ \mbox{ iff } \ & \MMM  \models \phi \mbox { and } \MMM \models \psi  \\
  \MMM & \models & \langle a \rangle \phi & \mbox{ iff } & \text{there is transition } s \xrightarrow{a} t \mbox { such that } (\LLL, t) \models \phi  \\
  \MMM & \models & \fBang A &\mbox{ iff } & \lambda(s) \subseteq A
\end{array}
\]

\end{definition}

\NI The first three clauses are standard, and Figure
\ref{figure:elAndBang:models} gives examples of models for the formula
$\MAY{a}{\MAY{b}{\TRUE}}$.  The last clause enforces the intended
meaning of $!A$: the available modalities in the model are \emph{at
  least as constrained} as required by $!A$. They may even be more
constrained, if the inclusion $\lambda(s) \subseteq A$ is proper. We
note in the case where the set $\Sigma$ of actions is infinite,
allowing $\lambda(s)$ to return arbitrary inifinite sets in addition
to $\sigma$ does not make a difference because $A$ is finite by
construction, so $\lambda(s) \subseteq A$ can never hold when
$\lambda(s)$ is infinite. Figure \ref{figure:elAndBang:moreMdels}
presents examples of validating (and otherwise) the formula $!\{a, b,
c\}$.

\begin{example}
The model in Figure \ref{example model} satisfies all the following formulae, amongst others:
\begin{eqnarray*}
\MAY{a} \\
\MAY{a} \MAY{b} \\
\MAY{a} \fBang \{b,c\} \\
\MAY{a} \fBang \{b,c,d\} \\
\MAY{c} \\
\MAY{c} \fBang \{\} \\
\MAY{c} \fBang \{a\} \\
\MAY{c} \fBang \{a,b\} \\
\MAY{a} \land \MAY{c}  \\
\MAY{a} (\MAY{b} \land \fBang \{b,c\}
\end{eqnarray*}
The same model does \emph{not} satisfy any of the following formulae:
\begin{eqnarray*}
\MAY{b} \\
\fBang \{a\} \\
\fBang \{a, c\} \\
\MAY{a} \fBang \{b\} \\
\MAY{a} \MAY{c} \\
\MAY{a} \MAY{b} \fBang \{c\} 
\end{eqnarray*}

\begin{figure}[H]
\centering
\begin{tikzpicture}[node distance=1.3cm,>=stealth',bend angle=45,auto]
  \tikzstyle{place}=[circle,thick,draw=blue!75,fill=blue!20,minimum size=6mm]
  \tikzstyle{red place}=[place,draw=red!75,fill=red!20]
  \tikzstyle{transition}=[rectangle,thick,draw=black!75,
  			  fill=black!20,minimum size=4mm]
  \tikzstyle{every label}=[red]
  
  \begin{scope}
    \node [place] (w1) {$\Sigma$};
    \node [place] (e1) [below left of=w1] {$\{b,c\}$}
      edge [pre]  node[swap] {a}                 (w1);      
    \node [place] (e2) [below right of=w1] {$\{\}$}
      edge [pre]  node[swap] {c}                 (w1);      
    \node [place] (e3) [below of=e1] {$\Sigma$}
      edge [pre]  node[swap] {b}                 (e1);      
  \end{scope}
    
\end{tikzpicture}
\caption{Example Model}
\label{example model}
\end{figure}
\end{example}

\begin{example}
Figure \ref{threemodels} shows various models of $\MAY{a} \MAY{b}$. 

Because \ELABR{} does not include any of the ``complexifying'' operators $\neg, \lor, $ or $\Rightarrow$, \ELABR{} has the unusual property that every satisfiable formula has a unique (up to isomorphism) simplest model that satisfies it.
In Figure \ref{threemodels}, the left model is the unique simplest model satisfying$\MAY{a} \MAY{b}$.
This property will be used in Section \ref{decisionprocedure} to construct a \emph{linear-time} decision procedure.
\input{figure:elAndBang:models}
\end{example}

\begin{example}
Figure \ref{more models} shows one model that does, and one that does not, satisfy the formula $\fBang \{a,b\}$.

\input{figure:elAndBang:moreMdels}
\end{example}

\begin{example}
Because \ELABR{} does not include any of the ``complexifying'' operators $\neg, \lor, $ or $\Rightarrow$, the only tautological formulae that are true in all models are $\top$ and conjunctions of $\top$.
But there are an infinite number of distinct contradictory formulae that are false in all models.
For example:
\begin{eqnarray*}
\MAY{a} \land \fBang \{\} \\
\MAY{a} \land \fBang \{b\} \\
\MAY{a} \land \fBang \{b, c\} \\
\MAY{b} \land \fBang \{\} \\
...
\end{eqnarray*}
\end{example}

\begin{definition}
Let $\Gamma$ be an arbitrary set of formulae. We say \emph{$\Gamma$
  semantically implies $\phi$}, written $\Gamma \models \phi$,
provided for all eremic models $\MMM$ if it is the case that $\MMM
\models \Gamma$ implies $\MMM \models \phi$. 
\richard{We do not define $\models \Gamma$ for a set $\Gamma$, only for individual formulae - do we want to change this definition to be of the form $\phi \models \psi$?}
\end{definition}

\begin{example}
\ELABR{} shares with HML the following implications:
\begin{eqnarray*}
\MAY{a} \MAY{b} \models \MAY{a} \\
\MAY{a} (\MAY{b} \land \MAY{c}) \models \MAY{a} \MAY{b}
\end{eqnarray*}
But because \ELABR{} is restricted to deterministic models, it also validates the following formula (which HML does not):
\begin{eqnarray*}
\MAY{a} \MAY{b} \land \MAY{a} \MAY{b}  \models \MAY{a} (\MAY{b} \land \MAY{c})
\end{eqnarray*}
\ELABR{} also validates all implications in which the set of constraints is relaxed from left to right. For example:
\begin{eqnarray*}
\fBang \{\} \models \fBang \{a\} \\
\fBang \{\} \models \fBang \{a, b\} \\
...
\end{eqnarray*}
\end{example}
