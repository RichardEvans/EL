\section{Quantified EL}

We can add variables and quantifiers to EL in the usual way.
\begin{definition} 
Let $\Sigma$ be a non-empty set of actions, ranged over by $a, a',
...$ as before.  Given a set $\mathcal{V}$ of \emph{variables}, with
$x, x', y, y', ...$ ranging over $\mathcal{V}$, the \emph{terms},
ranged over by $t, t', ...$ and formulae of QEL are given by the
following grammar:

\begin{GRAMMAR}
  t
     &\quad ::= \quad & 
  x
     \VERTICAL 
  a
  \\[1mm]
  \phi 
     &\quad ::= \quad & 
  \TRUE 
     \VERTICAL 
  \phi \AND \psi
     \VERTICAL 
  \MAY{t}{\phi}
     \VERTICAL 
  \fBang A 
     \VERTICAL 
  \exists x . {\phi}
     \VERTICAL 
  \forall x . {\phi}
\end{GRAMMAR}

\NI Now $A$ range over finite subsets of terms.  The \emph{free
  variables} of a $\phi$, denoted $\FV{\phi}$ is given as expected,
e.g.~$\FV{\MAY{x}{\phi}} = \{x\} \cup \FV{\phi}$ and $\FV{!A} =
\bigcup_{t \in A}\FV{t}$ where $\FV{a} = \emptyset$ and $\FV{x} =
\{x\}$.
\end{definition}

\begin{definition}
The semantics of quantified eremic logic is constructed along
conventional lines. An \emph{environment} is a map $\sigma : V
\rightarrow \Sigma$ with finite domain.  We write $\sigma, x : a$ for
the environment that is just list $\sigma$, except it also maps $x$ to
$a$, implicitly assuming that $x$ is not in $\sigma$'s domain.  The
\emph{denotation} $\SEMB{t}_{\sigma}$ of a term $t$ under an
environment $\sigma$ is given as follows:
\[
   \SEMB{a}_{\sigma} = a
      \qquad\qquad
   \SEMB{x}_{\sigma} = \sigma(x)
\]
where we assume that $\FV{t}$ is a sumbset of the domain of $\sigma$.

The \emph{satisfaction
  relation} $\MMM \models_{\sigma} \phi$ is defined whenever
$\FV{\phi}$ is a subset of $\sigma$'s domain. It is given by the
following clauses, where we assume that $\MMM = (\LLL, s)$ and $\LLL =
(S, \rightarrow, \lambda)$.

\[
\begin{array}{lclcl}
  \MMM & \models_{\sigma} & \top   \\
  \MMM & \models_{\sigma} & \phi \AND \psi &\ \mbox{ iff } \ & \MMM  \models_{\sigma} \phi \mbox { and } \MMM \models_{\sigma} \psi  \\
  \MMM & \models_{\sigma} & \langle t \rangle \phi & \mbox{ iff } & \text{there is transition } s \TRANS{\SEMB{t}_{\sigma}} s' \mbox { such that } (\LLL, s') \models_{\sigma} \phi  \\
  \MMM & \models_{\sigma} & \fBang A &\mbox{ iff } & \lambda(s) \subseteq \{\SEMB{t}\ |\ t \in A\} \\
  \MMM & \models_{\sigma} & \forall x.\phi &\mbox{ iff } & \text{for all} \ a \in \Sigma\ \text{we have}\ \MMM \models_{\sigma, x : a} \phi \\
  \MMM & \models_{\sigma} & \exists x.\phi &\mbox{ iff } & \text{there exists} \ a \in \Sigma \ \text{such that}\  \MMM \models_{\sigma, x : a} \phi
\end{array}
\]


\end{definition}

In QEL, we can say that there is exactly one king of France, and he is bald, as:
\[
\exists x . \MAY{king} \MAY{france} ! \{x\} \land \MAY{x} \MAY{bald}
\]
Expressing this in predicate logic is significantly more cumbersome:
\[
\exists x. king(france, x) \land bald(x) \land \forall y. king(france, y) \rightarrow y = x
\]
The predicate logic version uses an extra universal quantifier, and also requires the identity relation (which itself requires the schema of the Indiscernibility of Identicals ).

To say that every person has exactly one sex, which is either male or female, we can write in QEL:
\[
\forall x . \MAY{x} \MAY{person} \rightarrow \MAY{x} \MAY{sex} ! \{male, female\} \land \exists y . \MAY{x} \MAY{sex} (\MAY{y} \land \fBang \{y\})
\]
This is significantly more elegant than the equivalent in predicate logic:
\[
\forall x. person(x) \rightarrow \exists y . sex(x,y) \land (y = male \; \lor \; y = female) \land \forall z . sex(x,z) \rightarrow y = z
\]

To say that every traffic light is coloured either green, amber or red, we can write in QEL:
\[
\forall x. \MAY{x} \MAY{light} \rightarrow \MAY{x} \MAY{colour} !\{green, amber, red\} \land \exists y . \MAY{x} \MAY{colour} (\MAY{y} \land !\{y\})
\]
Again, this is significantly less verbose than the equivalent in predicate logic:
\[
\forall x. light(x) \rightarrow \exists y . colour(x,y) \land (y = green \; \lor \; y = amber \; \lor \; y = red) \land \forall z . colour(x,z) \rightarrow y = z
\]

\subsection{A translation from first-order logic to first-order eremic logic}

We now sketch how to translate from first-order logic to eremic
logic. Given that the latter is not nearly as expressive as the
former, we have to restrict our attention to a fragment of first-order
logic. For simplicity, we do not seek maximal generality. Instead we
look at a simple example that presentes the key ideas behind the
translation \emph{in nuce}.

Assume given a relational first-order signature. The relational
symbols are split into three parts: $R_1$ of unary relation symbols
ranged over by $u, ...$, and two sets of binary relation symbols
$R_2^{inj}$, ranged over by $i, ...$ and $R_2$, ranged over by $r,
...$. The meaning of the superscript in $R_2^{inj}$ will become clear
later.  We let $t, t', ...$ range over terms in this signature, which
can only be constants or variables. We look at the following
restricted set of formulae, called \emph{nice}.
\begin{GRAMMAR}
  \phi
     & \quad::=\quad &
  u(t) 
     \VERTICAL 
  i(t, t') 
     \VERTICAL 
  r(t, t') 
     \VERTICAL 
  \phi \AND \psi 
     \VERTICAL 
  \forall x.\phi 
     \VERTICAL 
  \exists x.\phi
\end{GRAMMAR}

\NI Note the absence of negation, disjunction, implication and
equality. We translate this fragment into first-order eremic logic as
follows.
\begin{itemize}

\item $\SEMB{u(t)} = \MAY{t}{u}$.

\item $\SEMB{i(t, t')} = \MAY{t}{\MAY{i}{(\MAY{t'}{} \AND !\{t'\})}}$.

\item $\SEMB{r(t, t')} = \MAY{t}{\MAY{i}{\MAY{t'}{}}}$.

\item $\SEMB{\phi \AND \psi} = \SEMB{\phi} \AND \SEMB{\psi}$.

\item $\SEMB{\forall x.\phi} = \forall x.\SEMB{\phi}$.

\item $\SEMB{\exists x.\phi} = \exists x.\SEMB{\phi}$.

\end{itemize}

\NI A first-order model $\CAL{M}$ for the signature above is called
\emph{nice} provided the interpretation $r^{\CAL{M}}$ of all relations
$i \in R_2^{inj}$ is injective, i.e.~whenever $(x, y), (x, z) \in
i^{\CAL{M}}$, then $y = z$. We now translate nice models $\CAL{M}$
with universe $U$ to eremic models $\SEMB{\CAL{M}}$.

The eremic transition system $\LLL = (S, \rightarrow, \lambda)$ is given by
the following data.
\begin{itemize}

\item The \emph{actions} are given as $\Sigma = U \cup R_1 \cup
  R_2^{inj} \cup R_2$

\item A \emph{home} state $h \in S$, labelled $\Sigma$.

\item For each $u \in R_1$ and all $x \in u^{\CAL{M}}$ a fresh state
  $s \in S$ and transitions
\[
   h \TRANS{x} s \TRANS{u} h,
\]
where $s$ is labelled $\Sigma$.

\item For each $i \in R_2^{inj}$ and all $(x, y)  \in
i^{\CAL{M}}$ two fresh states $s, s' \in S$ and transitions
\[
   h \TRANS{x} s \TRANS{i} s' \TRANS{y} h,
\]
where $s$ is labelled $\Sigma$ and $s'$ is labelled $\{y\}$.

\item For each $r \in R_2$ and all $(x, y)  \in                                                                         
r^{\CAL{M}}$ two fresh states $s, s' \in S$ and transitions
\[
   h \TRANS{x} s \TRANS{r} s' \TRANS{y} h,
\]
where $s$ and $s'$ are both labelled $\Sigma$.

\end{itemize}

\NI Now $\SEMB{\CAL{M}} = (\LLL, h)$.

It is straightforward to show that translation has the expected 
properties.

\begin{theorem}
Let $\phi$ be a nice first-order formula, $\CAL{M}$ be a nice
first-order model and $\sigma$ an environment. Then:
\[
   \CAL{M} \models_{\sigma} \phi
      \qquad\text{iff}\qquad
   \SEMB{\CAL{M}} \models_{\sigma} \SEMB{\phi}
\]
\end{theorem}

\NI Note that the encoding can easily be generalised to $n$-ary
relations for all $n$, and also to finite-width relations.  What does
the latter mean? Let $r$ be an $n$-ary relation symbol in the ambient
first-order signature. Let $\CAL{M}$ be a model. The interpretation
$r^{\CAL{M}}$ of $r$ in $\CAL{M}$ is called an $(i, k)$-relation,
where $0 < i \leq n$, and $k$ is arbitrary, provided for the
cardinality of the set
\[
   \{ y | (x_1, ..., x_{i-1}, y, x_{i+1}, ..., x_{n}) \in r^{\CAL{M}} \}
\]
does not exceed $k$. We say $r^{\CAL{M}}$ is finite-width if for each
$i$ there is $k$ such that $r^{\CAL{M}}$ is a $(i, k)$-relation.

