\section{Core eremic logic: the EL$[\AND, !]$ fragment}\label{coreEL}

In this section we introduce the syntax and semantics of eremic logic.
Then we establish key completeness of the the proof rules and prove a
the compactness theorem via a translation into first-order logic. We
focus on a small core of eremic logic, leaving extensions to later
section.

\subsection{Syntax}



\begin{definition} Let $\Sigma$ be a set of \emph{actions}.
Actions are ranged over by $a, a', a_1, b, ...$, and $A$ ranges over
finite subsets of $\Sigma$. The \emph{formulae}, ranged over by
$\phi, \psi, \xi ...$, of the \emph{EL$[\AND, !]$-fragment} are given
by the following grammar.

\begin{GRAMMAR}
  \phi 
     &\quad ::= \quad & 
  \TRUE 
     \VERTICAL 
  \phi_1 \AND \phi_2  
     \VERTICAL 
  \MAY{a}{\phi}
     \VERTICAL 
  \fBang A 
\end{GRAMMAR}

\NI The $!$ operator is used to restrict the allowable transitions
coming out of a state.  Intuitively, $\fBang A$ means that the
\emph{only} transitions coming out of the current state are those
specified in $A$.

\martin{Add better explanation of $\fBang$, and some examples?}
\end{definition}

\subsection{Semantics}

\NI We now give the semantics of EL$[\AND, !]$-formulae using
transition systems, as described in Section \ref{preliminaries}, but
augmented with labels on states.

\begin{definition}
An \emph{eremic transition system} is a triple $(S, \rightarrow,
\lambda)$, where $(S, \rightarrow)$ is a labelled transition system
over $\Sigma$, and $\lambda$ is a function from states to sets of
actions (not necessarily finite), subject to the following constraint:
for all states $s \in S$ it is the case that $ \{a \fOr \exists t \; s
\xrightarrow{a} t\} \subseteq \lambda(s)$.

\end{definition}

\NI The intended interpretation is that $\lambda(w)$ is the set of allowed
transition symbols emanating from $w$.  The $\lambda$ function is the
semantic counterpart of the $!$ operator.

\begin{definition}
A \emph{model}, ranged over by $\MMM, \MMM', ...$, is a pair $(\LLL,
s)$, where $\LLL$ is an eremic transition system $(S, \rightarrow,
\lambda)$, and $s$ is a state from $S$.
\end{definition}

\input{figure:elAndBang:models}

\begin{definition}
The \emph{satisfaction relation} $\MMM \models \phi$ is defined
inductively by the following clauses, where we assume that $\MMM =
(\LLL, s)$ and $\LLL = (S, \rightarrow, \lambda)$.

\[
\begin{array}{lclcl}
  \MMM & \models & \top   \\
  \MMM & \models & \phi_1 \AND \phi_2 &\ \mbox{ iff } \ & \MMM  \models \phi_1 \mbox { and } \MMM \models \phi_2  \\
  \MMM & \models & \langle a \rangle \phi & \mbox{ iff } & \text{there is a } s \xrightarrow{a} t \mbox { such that } (\LLL, t) \models \phi  \\
  \MMM & \models & \fBang A &\mbox{ iff } & \lambda(s) \subseteq A
\end{array}
\]

\end{definition}

\NI Figure \ref{figure:elAndBang:models} gives examples of models for
the formula $\MAY{a}{\MAY{b}{\TRUE}}$. \martin{Add more examples/discussion.}

\subsection{Inference Rules}

\input{figure:elAndBangRules}

\NI We now present the inference rules for eremic logic. 

\begin{definition} Judgements are of the following form.
\[
  \phi \judge \psi.
\]
Figure \ref{figure:elAndBangRules} presents all proof rules. There are
no axioms.
\end{definition}

\NI Note that $\phi$ and $\psi$ are single formulae, not sequents.  By
using single formalae, we can avoid structural inference rules.  EL
proof rules can be grouped in two parts: standard rules and rules
unique to EL.  Standard rules are [\RULENAME{Identity}],
[\RULENAME{$\top$-Right}], [\RULENAME{$\bot$-Left}],
[\RULENAME{Transitivity}], [\RULENAME{$\AND$-Left 1}],
[\RULENAME{$\AND$-Left 2}] and [\RULENAME{$\AND$-Right}] hardly need
explanation as they are variants of familiar rules for propositional
logic, see e.g.~\cite{TroelstraAS:basprot,vanDalenD:logstr}.  We now
explain the rules that give EL's its distinctive properties: the
relations betwen $\langle \rangle$, $!$ and $\bot$.

The rule [\RULENAME{$\bot$-Right 1}] axiom captures the core
\emph{exclusion} property of !: for example if $A = \{male, female\}$
then $\MAY{orange}{\phi}$ is incompatible with $!A$. Thus $!A \AND
\MAY{orange}{\phi}$ must be false.

The rule [\RULENAME{$\bot$-Right 2}] expresses that falsity is 'global'
  and cannot be surpressed by prefixing. For example
  $\MAY{orange}{\bot}$ is false, simply because $\bot$ is already
  false.

Relatedly, the rule [\RULENAME{Transition Normal}] enables us to
prefix an inference with a may-modality. For example \martin{add good
  example here.}. Note that it is vital for soundness that $\phi$ in $\phi
\judge \psi$ is a single formula. If we used transitional sequents $\phi_1, ..., \phi_n \judge \psi$,
then the rule
\[
   \ONEPREMISERULE
   {
     \phi_1, ..., \phi_n \judge \psi
   }
   {
     \MAY{a}{\phi_1}, ..., \MAY{a}{\phi_n} \judge \MAY{a}{\psi}
   }
\]
is unsound. \martin{explain why, and why this is significant}. This
restriction is also in place in \cite{GaySJ:typcalosp} where a
Curry-Howard corrospondence between a fragment of linear logic
\cite{GirardJY:linlog,GirardJY:protyp} and a process calculus is
introduced. We discuss the relationship between EL and linear logic in
general, and linear logic's additive conjunction in Section
\ref{conclusion}.


The three rules [\RULENAME{!-Left}, \RULENAME{!-Right 1},
  \RULENAME{!-Right 2}] jointly express of the subset relation
$\subseteq$ on sets of symbols relates to provability. Readers
familiar with object-oriented programming will recognise
[\RULENAME{!-Left}] as contra-variant subtyping and [\RULENAME{!-Right
    1}] as covariant subtyping. Honda \cite{HondaK:thetypftpc}
develops a full theory of subtyping based on similar ideas.  All three
rules embody the intuition that whenever $A \subseteq A'$ then
asserting that $!A'$ is as strong as, or a stronger statement than
$!A$. [\RULENAME{!-Left}] simply states that we can always strengthen
our premise, while [\RULENAME{!-right 1}] allows us to weaken the
premise. \martin{add an intuitive explanation for [\RULENAME{!-right 2}]!}!

Note that the logic has no axioms. One reason for a purely rule-based
presentation is the absence of implication in the present fragment of
EL. \martin{explain in more detail!}

We close this subsection with a key meta-theorem.

\begin{theorem}\label{theorem:elAndBang:soundComplete}
The rules in Figure \ref{figure:elAndBangRules} are sound and complete:
\begin{enumerate}

\item\label{theorem:elAndBang:sound} (Soundness) $\phi \judge \psi$ implies $\phi \models \psi$.

\item\label{theorem:elAndBang:complete} (Completeness) $\phi \models \psi$ implies $\phi \judge \psi$.

\end{enumerate}
\end{theorem}

\NI Soundness is immediate from the definitions. Proof of completeness is
deferred to Section \ref{completenessProof}. 

\subsection{Example inferences}

We give some example inferences that illustrate how EL is used in
practise.
\martin{Add some example assertions here, for example some of those we
  use later.}

\subsection{Proof of completeness}\label{completenessProof}

\NI We now prove completeness of the rules in Figure
\ref{figure:elAndBangRules}.  The proof requires the development of
the following additional technology which is also useful in other
contexts.

\begin{itemize}

\item An ordering $\MODELLEQ$ on models, which enables us to speak of
  the simplest model satisfying a formula.

\item An algorithm which gives the simplest model for a formula.

\item An algorithm which gives the a formula characterising a model.

\end{itemize}

\NI We now develop these three in turn and then prove completeness.

\subsubsection{A partial ordering on models}

We shall define a partial-ordering on models by extending the notion of simulation on labeled transition systems.

\begin{definition}
Let $\LLL_i = (S_i, \rightarrow_i, \lambda_i)$ be eremic transition
systems for $i = 1, 2$.  A relation $\RRR \subseteq S_1 \times S_2$ is
a \emph{simulation from $\LLL_1$ to $\LLL_2$}, provided:
\begin{itemize} 

\item $\RRR$ is a simulation on the underlying transition systems. 

\item Whenever $(s, t) \in \RRR$ then also $\lambda_1(s) \supseteq
  \lambda_2(t)$.

\end{itemize}

\NI If $\MMM_i = (\LLL_i, s_i)$ are models, we say $\RRR$ is a
\emph{simulation from $\MMM_1$ to $\MMM_2$}, provided the following hold.

\begin{itemize}

\item $\RRR$ is a simulation from $\LLL_1$ to $\LLL_2$ as eremic transition systems.

\item  $(s_1, s_2) \in \RRR$. 

\end{itemize}

\NI We say $\MMM_2$ \emph{simulates} $\MMM_1$ if there is a simulation $\RRR$ 
from $\MMM_1$ to $\MMM_2$.



%% We say $\RRR$ is a \emph{bisimulation} on eremic transition systems
%% and models, respectively, if $\RRR$ and $\RRR^{-1}$ are. We say
%% $\LLL_1$ and $\LLL_2$ are \emph{bisimilar}, written $\LLL_1 \BISIM
%% \LLL_2$, if there is a bisimulation $\RRR$, relating $\LLL_1$ and
%% $\LLL_2$.  Bisimilarity is defined likewise for models. \martin{should
%%   we break up this definition into several smaller parts?}
\end{definition}

We use the notion of
simulation to define an order $\MODELLEQ$ on models, which gives rise
to a bounded lattice of models.

\begin{definition}
The binary relation $\MODELLEQ$ on models is defined as
\[
   \MMM \MODELLEQ \MMM' \text{ iff } \MMM \text{ simulates } \MMM' .
\]
\end{definition}
It turns out that $\MODELLEQ $ on models is not just a partial order, but
almost a complete lattice, except that a bottom element is missing.
\begin{definition}
We extend the collection of models with a single \emph{bottom} element
$\bot$, where $\bot \models \phi$ for all $\phi$. 
We extend the relation $\MODELLEQ $  and stipulate that $\bot
\MODELLEQ \MMM$ for all models $\MMM$.
\end{definition}

\begin{theorem}
\[
\MMM \MODELLEQ \MMM'
\qquad\text{iff}\qquad
 \{\phi\ |\ \MMM \models \phi \} \supseteq  \{\phi\ |\ \MMM' \models \phi \}.
\]
\end{theorem}

\begin{theorem}
The collection of models together with $\bot$, and ordered by $\MODELLEQ $
is a complete lattice.  \martin{strictly speaking this is NOT true, because we
  can simply rename states and get new models that break
  e.g. anti-symmetry. I guess we need to quotient somehow, e.g.  $(
  (\{w\}, \{\}, \{w \mapsto \Sigma\}), w)$ and $( (\{v\}, \{\},
  \{v \mapsto \Sigma\}), v)$ need to be equated.}
\end{theorem}
\begin{proof}
\martin{worth doing?}  Example: The topmost element in the lattice is
the model $( (\{w\}, \{\}, \{w \mapsto \Sigma\}), w)$ (for some state
$w$): this is the model with no transitions and no transition
restrictions.\martin{I think this is not well-defined if $\Sigma$ is
  infinite. Remember that the labelling function $\lambda$ now always
  must map to finite sets of actions.}
\end{proof}

\subsubsection{Computing the simplest model satisfying a formula}

\NI In $\MODELLEQ $ we have a notion of model simplicity.  We can now
compute $\SIMPL{\phi}$, the simplest model w.r.t.~$\MODELLEQ $ that
satisfies $\phi$.

\begin{eqnarray*}
  \SIMPL{\top} &\ = \ & ( (\{v\}, \{\}, \{v \mapsto \Sigma\}), v)  \\
  \SIMPL{\fBang A} & = & ( (\{v\}, \{\}, \{v \mapsto A\}), v)  \\
  \SIMPL{\phi_1 \AND \phi_2} & = & \SIMPL{\phi_1} \sqcap \SIMPL{\phi_2}  \\
  \SIMPL{\langle a \rangle \phi} 
     & = & ( (S \cup \{w'\}, \rightarrow \cup (w' \xrightarrow{a} w), \lambda \cup \{w' \mapsto \Sigma\}]), w')  \\
		& & \mbox{where }\SIMPL{\phi} = ( (S, \rightarrow, \lambda), w) \mbox{and } w' \mbox{ is a new state} \\
                &&  \mbox{not appearing in }S 
\end{eqnarray*}

\NI The only complex case is the clause for $\SIMPL{\phi_1 \AND \phi_2}$,
which uses the $\sqcap$ function, defined as follows, where we assume
that the sets of states in the two models are disjoint.

\begin{eqnarray*}
  \bot \sqcap \MMM  &\ =\ &  \bot  \\
  \MMM \sqcap \bot      & = &  \bot  
     \\
  \MMM \sqcap \MMM'
     & = & 
  \begin{cases}
    \mathsf{merge}(\MMM, \MMM') & \text{if}\ \mathsf{consistent}(\MMM, \MMM') \\
    \bot & \text{else}
  \end{cases}
\end{eqnarray*}

\NI The $\mathsf{consistent}$ predicate is true of models $m$ and $n$ if
the out-transitions on $m$'s root state respect the labelling on $n$'s
root state, and the out-transitions on $n$'s root state respect the
labelling on $m$'s root state. In other words:

\begin{eqnarray*}
  \mathsf{consistent}(\MMM, \MMM') 
     &\ \mbox{ iff }\ & 
  \begin{cases}
    \mathsf{out}(\MMM) \subseteq \mathsf{restriction}(\MMM') \mbox{ and}  \\
    \mathsf{out}(\MMM') \subseteq \mathsf{restriction}(\MMM) 
  \end{cases}
\end{eqnarray*}

\NI Here:

\[
\begin{array}{rcl}
  \mathsf{out}(((S,\rightarrow,\lambda),w)) 
     &\ =\ & \{ a \fOr \exists w' . w \xrightarrow{a} w'\}  \\
  \mathsf{restriction}(((S,\rightarrow,\lambda),w)) 
    & = & 
  \lambda(w) 
\end{array}
\]

\NI Now the $\mathsf{merge}$ function fuses two  models together:
\[
   \mathsf{merge}( ( (S, \rightarrow, \lambda), w),  ( (S', \rightarrow', \lambda'), w')) 
      \ =\ 
   ((S \cup S', \rightarrow \cup \rightarrow'_2, \lambda_2 \cup \lambda'_2), w)
\]
where:
\begin{eqnarray*}
  \rightarrow'_2 &\ =\ & \rightarrow' \mbox{ with } w' \mbox{ replaced by } w  \\
  \lambda_2 & = & \lambda \mbox{ with } w \mapsto \lambda(w) \cap \lambda'(w')  \\
  \lambda'_2 & = & \lambda' \mbox{ with } w' \mbox{ removed } 
\end{eqnarray*}

\NI It is easy to show that $\SIMPL{\cdot}$ has the following properties:

\begin{itemize}

\item $\SIMPL{\phi} \models \phi$.

\item If $\MMM' \models \phi$ and  $\MMM \MODELLEQ \MMM'$ then also  $\MMM \models \phi$.
 
\end{itemize}

\subsubsection{Characteristic formulae}

The function $\SIMPL{\cdot}$ goes form formulae to models. Now we go
the other way: given a model $\MMM$, we compute its characteristic
formula $\CHAR{m}$. The formula $\SIMPL{\MMM}$ characterises the model
$\MMM$ in the following sense. \martin{Check that they are
  true. Proofs?}

\begin{itemize}

\item  $\MMM \models \phi$ implies $\CHAR{\MMM} \models \phi$.

\item  $\MMM \models \CHAR{ \MMM' }$ exactly when $\MMM \MODELLEQ \MMM'$.

\item $\MMM = \BIGLUB \{\MMM' \ |\ \MMM' \models \CHAR{\MMM} \}$.

\end{itemize}

\martin{we must define $\BIGLUB$!}

\NI This notion of characteristic formula is closely related to
characteristic formulae in Hennessy-Milner logic
\cite{AcetoL:chaforfata} and Hoare logics
\cite{HondaK:descriptive,ChargueraudA:provertcf}. Here is the
definition of $\CHAR{\cdot}$.

\begin{eqnarray*}
  \CHAR{\bot} &\ =\ & \langle a \rangle \top \AND ! \emptyset  \mbox{ for some symbol }a  \\
  \CHAR{\MMM, w} & = & \mathsf{bang}(\MMM,w) \AND \bigwedge_{(a,w') \in \mathsf{trans}(l,w)} \langle a \rangle \CHAR{\MMM, w'}  
\end{eqnarray*}

\martin{Note that in its current form $\CHAR{\bot}$ defines a
  relation, not a function, because $a$ an vary.}

\NI The functions $\mathsf{bang}(\cdot)$ and $\mathsf{trans}$ on
models are given by the following clauses.

\begin{eqnarray*}
  \mathsf{bang}((S,\rightarrow,\lambda),w) 
     & \ = \ & 
  \begin{cases}
    \top & \mbox{ if } \lambda(w) = \Sigma  \\
    ! \; \lambda(w) & \mbox{ otherwise }  
  \end{cases} \\
  \mathsf{trans}((S,\rightarrow, \lambda),w) & \ = \ & \{(a,w') | w \xrightarrow{a} w' \} 
\end{eqnarray*}

\NI Note that $\CHAR{\MMM}$ is finite if $\MMM$ contains no cycles and if
$\lambda(x)$ is either $\Sigma$ or finite for all states $x$.
Note also that $\SIMPL{\cdot}$ and $\CHAR{\cdot}$ are inverses of each other in that:

\begin{itemize}

\item $\SIMPL{\CHAR{\MMM}} \ = \  \MMM$. \martin{Is this set-theoretic equality?}

\item $\CHAR{\SIMPL{\phi}}$ iff $\phi$.\martin{is this $\vdash$ or $\models$?}

\end{itemize}

\NI We are now ready to prove completeness.  We will show that $\phi
\models \psi$ implies there is a derivation of $\phi \judge \psi$.  Our proof
will make use of two key facts:

\begin{lemma}\label{lemma:completeness:4}
If $m \models \phi$ then $\CHAR{\MMM} \judge \phi$.
\end{lemma}

\begin{lemma}\label{lemma:completeness:5}
For all formulae $\phi$, we can derive $\phi \judge \CHAR{\SIMPL{\phi}}$.
\end{lemma}

\martin{Add short explanation of Lemma \ref{lemma:completeness:4}}.

As to Lemma \ref{lemma:completeness:5}, $\SIMPL{\phi}$ is the simplest model
satisfying $\phi$, and $\CHAR{\MMM}$ is the simplest formula describing
$m$, so $\CHAR{\SIMPL{\phi}}$ is a simplified form of $\phi$. This lemma
states that EL has the inferential capacity to transform any
proposition into its simplified form.

With these two lemmas in hand, the proof of completeness is
straightforward.  Assume $\phi \models \psi$.  Then all models which satisfy
$\phi$ also satisfy $\psi$.  In particular, $\SIMPL{\phi} \models \psi$.  Then
$\CHAR{\SIMPL{\phi}} \judge \psi$ by Lemma \ref{lemma:completeness:4}.  But we
also have, by Lemma \ref{lemma:completeness:5}, $\phi \judge
\CHAR{\SIMPL{\phi}} $.  So by transitivity, we have $\phi \judge \psi$.  \qed


\subsection{The standard translation from  EL into FOL}\label{standardTranslation}

We now present a translation from EL to first-order logic. We have two
key purposes in mind:

\begin{itemize}

\item To facilitate the comparison between EL and conventional
  first-order logic, to pin down precisely where EL and first-order
  logic differ and where they don't.

\item To enable technology transfer between EL and other logics. We
  are inspired here in particular by the standard translation of modal
  logic into first-order logic \cite{BlackburnP:modlog} which has
  allows the transfer of interesting results such as compactness to
  modal logic, but has also given rise to many interesting concepts in
  first-order logic.  Historically, fragments of first-order logic
  that were studied were defined by quantifier hierarchies. Modal
  logics picks out very different fragments. For example fragments
  closed under bisimulation, guarded fragments, fragments with
  restricted numbers of variables.

\end{itemize}

\input{figure:embedding}

\NI We will translate EL into a restricted fragment of FOL \martin{one-sorted FOL?} (cf.~Figure
\ref{figure:embedding}). The translation makes use of three types of
predicate:

\begin{itemize}

\item A 0-place predicate $\top$, which is true in all models.

\item A set of two-place predicates $Arr_a(x, y)$, one for each $a \in
  \Sigma$, where $x$ and $y$ are of type $State$. $Arr_a(x, y)$
  is true if $x \xrightarrow{a} y$.

\item A set of one-place predicates $Restrict_A$, one for each finite
  subset $A \subseteq \Sigma$.  $Restrict_{A}(x)$ is true if
  $\lambda(x) = A$.

\end{itemize}

\NI Choose two fixed variables $x_1, x_2$, let $a$ range over actions
in $\Sigma$, and $A$ over finite subsets of
$\Sigma$. Then the restricted fragment of FOL that is the target
of our translation is given by the following grammar.

\begin{GRAMMAR}
  \phi 
     &\quad ::= \quad&
  \top \fOr Arr_{a}(x_1, x_2)\fOr Restrict_A(x_1) \fOr \phi_1 \AND \phi_2 \fOr \exists x_1 . \phi 
\end{GRAMMAR}

\NI Notice that this fragment of FOL has no negation, disjunction,
implication, or universal quantification. Notice also that two
variables suffice.

The translation of an EL formula is relative to a variable $x$ (which
will be instantiated to the particular state at which we are
evaluating the formula):

\begin{eqnarray*}
  T_x(\top) & \ = \ & \top  \\
  T_x(\phi_1 \AND \phi_2) & \ = \ & T_x(\phi_1) \AND T_x(\phi_2)  \\
  T_x(\langle a \rangle \phi) & \ = \ & \exists y \; . \; Arr_a(x,y) \AND T_y(\phi)  \\
  T_x(\fBang A) & \ = \ & Restrict_A(x) 
\end{eqnarray*}

\NI So, for example:
\[
T_x(\langle a \rangle \top \AND \fBang \{a\}) = \exists y \; . \; Arr_a(x,y) \AND \top \AND Restrict_{\{a\}}(x)
\]


\subsection{Compactness}

\NI First-order logic has compactness: a set $S$ of sentences has a
model exactly when every finite subset of $S$ does \cite[Chapter
  4.3]{EndertonHB:matinttl}. What about eremic logic?  We now
establish compactness for EL. Our proof adapts compactness proofs from
modal logics \cite{BlackburnP:modlog} to the standard translation from
eremic logic into first-order logic, introduced in Section
\ref{standardTranslation}.


\begin{definition} 
Eremic logic with a set $\Sigma$ of actions induces a first-order
signature $\SSS$ as follows.

\begin{itemize}

\item There are no constants.

\item We have the following relations:

  \begin{itemize}

    \item A 0-ary relation $\top$.
    \item For each finite subset $A$ of $\Sigma$ a relation $\RESTRICT{A}{\cdot}$.
    \item For each action $a \in \Sigma$ a binary relation $\ARROW{a}{\cdot}{\cdot}$.

  \end{itemize}

\item No functions, the signature is relational.

\end{itemize}

\end{definition}

\begin{definition}
Let $\LLL = (S, \rightarrow, \lambda)$ be an eremic transition
system. Clearly $\LLL$ gives rise to an $\SSS$-model $\SEMB{\LLL}$ as
follows.
\begin{itemize}

\item The universe is the set $S$ of states.

\item The relation symbols are interpreted as follows.

  \begin{itemize}

    \item $\top$ always holds.
    \item Each relation $\RESTRICT{A}{\cdot}$ is interpreted by the set $\{s \in S\ |\ \lambda (s) = A\}$.
    \item Each  relation $\ARROW{a}{\cdot}{\cdot}$ is given as $\{( s, t )\in S^2\ |\ s \TRANS{a} t\}$.

  \end{itemize}
\end{itemize}

\end{definition}

\NI We denote this model by $\SEMB{\MMM}$. The correctness of the
standard translation is given by the following theorem.

\begin{theorem}[Local and global correspondence theorem]\label{correspondence:theorem}
Let $A$ be an eremic formula, and $\MMM = (\LLL, s)$ a model, then:
\[
   \MMM \models \phi \quad  \text{iff} \quad \SEMB{\LLL} \models_{x \mapsto s} \SEMB{\phi}_x.
\]
\end{theorem}
\begin{proof}
By induction on the structure of $\phi$.\martin{do a few cases, put in appendix.}
\end{proof}

We have just shown how to convert eremic to first-order models.
Clearly we can also go the other way and start out with a first-order
model for the signature defined above, and convert it
to an eremic model.

\begin{definition}
Let $\CAL{M}$ be a first-order model for $\SSS$. We construct an eremic transition system
 $\CAL{M}^{\sharp} = (S, \rightarrow, \lambda)$. 

\begin{itemize}

\item The states $V$ are given by the $\MMM$ interpretation of states.

\item The reduction relation $s \TRANS{\alpha} t$ holds exactly when
  $\mathsf{Arrow}^{\CAL{M}}_a(x, y)$ is true.

\item The function $\lambda$ is given by the following clause:
  $\lambda(s) = A$ exactly when $\mathsf{Restrict}_{A}^{\CAL{M}}(x)$
  holds.

\end{itemize}

\end{definition}

\martin{The constructions of $\SEMB{\LLL}$ and $\CAL{M}^{\sharp}$ are kind of trivial. 
Do we need to spell them out explicitly?}

\begin{lemma}\label{modelIso:lemma}
For all $\LLL$ models $\MMM$: $\SEMB{\MMM^{\sharp}} = \MMM$.
Likewise, for all eremic models $\MMM$: 
 $\SEMB{\MMM}^{\sharp} = \MMM$.
\end{lemma}
\begin{proof}
To do.
\end{proof}

\begin{theorem}[Compactness of propositional eremic logic]
A set $T$ of eremic formulae is satisfiable iff each finite subset of
$T$ is satisfiable.
\end{theorem}
\begin{proof}
Let $T$ be a set of eremic formulae.  For any finite subset $T'$ of
$T$, assume that $T'$ is satisfiable.  Hence an eremic model $\MMM$
with state $s$ exists such that
\[
   \MMM \models_s A
\]
for each $A \in T'$. By Theorem \ref{correspondence:theorem} we know that
\[
   \SEMB{\MMM} \models_{x \mapsto s} \SEMB{A}_x.
\]
By compactness of FOL (Theorem \ref{compactnessFOL:theorem}) we thus know
that the set
\[
   \{ \SEMB{A}_x\ |\ A \in T\}
\]
has a model, say $\MMM_{T}$. Hence for all $A \in T$:
\[
   \MMM_T \models_{x \mapsto s} \SEMB{A}_x
\]
Using Lemma \ref{modelIso:lemma}, we conclude that
\[
   \MMM_T^{\sharp} \models_s A
\]
and $T$ is satisfiable.
\end{proof}

